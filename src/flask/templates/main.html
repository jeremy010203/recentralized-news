{% extends "template.html" %}
{% block header %}
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">
  <link rel="stylesheet" type="text/css" href="static/bootstrap/css/bootstrap.min.css"/>
  <script type="text/javascript" src="static/bootstrap/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="static/jquery/jquery.min.js"></script>
  <script type="text/javascript"> var $SCRIPT_ROOT = {{ request.script_root|tojson|safe }}</script>
  <style>
        html,body{height:100%;}

    .container-fluid {
      height:100%;
      background-color: grey;
    }
  </style>
</head>
{% endblock %}

{% block javascript %}
<script>

    function change_background(element, color) {
      element.style.backgroundColor = color
    }
  {% for module in modules %}
    setInterval({{ module.function }}, {{ module.interval }});
    function {{ module.function }}() {
      $.get($SCRIPT_ROOT + "/get_from_module/{{ module.url }}", function(data){
        var x = document.getElementsByName("{{ module.id }}")
        var i;
        for (i = 0; i < x.length; i++) {
            x[i].innerHTML = data;
            setTimeout(change_background.bind(null, x[i], x[i].style.backgroundColor), 200);
            x[i].style.backgroundColor = 'blue';
        }
      });
    }
  {% endfor %}
</script>
{% endblock %}
